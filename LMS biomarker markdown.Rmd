---
title: "LMS biomarker markdown"
author: "RC"
date: "8/13/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.


```{r}
require(gamlss)
library(gamlss)

CXM <- read.csv("CXM normal data.csv", header=TRUE, sep=",")

male <- subset(CXM, Sex == 'M', select=c("Sex", "Age", "CXM"))
               
youngmale <- subset(male, Age < 21, select=c("Sex", "Age", "CXM"))
 

```


```{r}
y<-youngmale$CXM
x<-youngmale$Age
m1<- lms(CXM, Age, families = "BCTo", data=youngmale,method.pb="ML",cent = c(3,10,25,50,75,90,97), col.cent=4, lty.centiles=c(4,3,2,1,2,3,4), calibration=TRUE, trans.x=TRUE, main="Male CXM norms", xlim = range(0, 21), ylim=range(0, 110))

```

```{r}
z<-z.scores(m1, youngmale$CXM, youngmale$Age)
plot(youngmale$Age, z, ylim=range(-4,4), xlim=range(0,21), pch=0, col="blue")
```




```{r}
#h<-gamlss(CXM~pb(youngmale$Age), sigma.fo=~pb(youngmale$Age), family = ST3(), data=youngmale)
```






